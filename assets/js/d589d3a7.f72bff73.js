"use strict";(self.webpackChunkgrit_docs=self.webpackChunkgrit_docs||[]).push([[7924],{385:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"getting-started","title":"Getting started","description":"This guide can be used to run the grit Scientific Data Management System locally or on a remote server.","source":"@site/docs/getting-started.md","sourceDirName":".","slug":"/getting-started","permalink":"/grit/getting-started","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Introduction","permalink":"/grit/intro"},"next":{"title":"Basic functionalities","permalink":"/grit/category/basic-functionalities"}}');var r=t(6070),s=t(8906);const a={sidebar_position:2},o="Getting started",c={},d=[{value:"Requirements",id:"requirements",level:2},{value:"Server requirements",id:"server-requirements",level:3},{value:"Running the app",id:"running-the-app",level:2},{value:"Get the environment",id:"get-the-environment",level:3},{value:"Start the database and app services",id:"start-the-database-and-app-services",level:3},{value:"Activate the admin user",id:"activate-the-admin-user",level:3},{value:"Mail service configuration",id:"mail-service-configuration",level:2},{value:"Maintaining the app",id:"maintaining-the-app",level:2},{value:"Backup the database",id:"backup-the-database",level:3},{value:"Restore the latest backup",id:"restore-the-latest-backup",level:3},{value:"Upgrading to a new version",id:"upgrading-to-a-new-version",level:3},{value:"Upgrading from previous sample docker compose",id:"upgrading-from-previous-sample-docker-compose",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"getting-started",children:"Getting started"})}),"\n",(0,r.jsx)(n.p,{children:"This guide can be used to run the grit Scientific Data Management System locally or on a remote server."}),"\n",(0,r.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/get-started/get-docker/",children:"docker"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/compose/install/",children:"docker compose"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Before continuing, ensure the Docker daemon is running."}),"\n",(0,r.jsx)(n.h3,{id:"server-requirements",children:"Server requirements"}),"\n",(0,r.jsxs)(n.p,{children:["grit has been shown to run smoothly on modest hardware such as ",(0,r.jsx)(n.a,{href:"https://www.hetzner.com/cloud/",children:"Hetzner CPX21"})," with over 200 millions data points."]}),"\n",(0,r.jsx)(n.p,{children:"Indicative requirements for less than 10 concurrent users:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"2 vCPUs @ 3 GHz"}),"\n",(0,r.jsx)(n.li,{children:"4 GB RAM"}),"\n",(0,r.jsx)(n.li,{children:"40 GB storage"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"running-the-app",children:"Running the app"}),"\n",(0,r.jsx)(n.h3,{id:"get-the-environment",children:"Get the environment"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Clone the ",(0,r.jsx)(n.a,{href:"https://github.com/grit42/grit-starter",children:"starter repo"})," or download and extract the ",(0,r.jsx)(n.a,{href:"https://github.com/grit42/grit-starter/archive/refs/heads/main.zip",children:"zip"})]}),"\n",(0,r.jsxs)(n.li,{children:["Copy the content of ",(0,r.jsx)(n.code,{children:".env.template"})," to ",(0,r.jsx)(n.code,{children:".env"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Some users may need to enable display of hidden files if using a file explorer"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Subsequent steps of this guide are to be executed in the cloned repository or the extracted zip unless instructed otherwise."}),"\n",(0,r.jsx)(n.h3,{id:"start-the-database-and-app-services",children:"Start the database and app services"}),"\n",(0,r.jsx)(n.p,{children:"Run the following command in a terminal to start the application:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"docker compose up\n"})}),"\n",(0,r.jsx)(n.h3,{id:"activate-the-admin-user",children:"Activate the admin user"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"admin"})," user must be activated to start using the application the first time it is started."]}),"\n",(0,r.jsxs)(n.p,{children:["Navigate to ",(0,r.jsx)(n.code,{children:"/app/core/activate/admin"})," (e.g. when running locally ",(0,r.jsx)(n.a,{href:"http://localhost:3000/app/core/activate/admin",children:"http://localhost:3000/app/core/activate/admin"}),") to activate the ",(0,r.jsx)(n.code,{children:"admin"})," user by configuring its password."]}),"\n",(0,r.jsx)(n.h2,{id:"mail-service-configuration",children:"Mail service configuration"}),"\n",(0,r.jsx)(n.p,{children:"User management, password recovery and two-factor authentication require an SMTP mail service."}),"\n",(0,r.jsxs)(n.p,{children:["The SMTP mail service can be configured through environment variables in the ",(0,r.jsx)(n.code,{children:".env"})," file."]}),"\n",(0,r.jsx)(n.p,{children:"The following variables are required:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"# Mailer configuration\nSMTP_SERVER=smtp.example.com\nSMTP_PORT=587\nSMTP_TOKEN=SMTP_TOKEN\nSMTP_USER=user@example.com\n\n# The URL at which grit is running\n# used to build activation and password reset URLs\nGRIT_SERVER_URL=https://grit.example.com\n"})}),"\n",(0,r.jsx)(n.h2,{id:"maintaining-the-app",children:"Maintaining the app"}),"\n",(0,r.jsx)(n.h3,{id:"backup-the-database",children:"Backup the database"}),"\n",(0,r.jsx)(n.p,{children:"It is a good idea to back up the database regularly and before upgrading.\nIf a backup already exists, it will be overwritten when making a new backup."}),"\n",(0,r.jsx)(n.p,{children:"Run the following command to back up the database:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"docker compose run --rm backup\n"})}),"\n",(0,r.jsx)(n.h3,{id:"restore-the-latest-backup",children:"Restore the latest backup"}),"\n",(0,r.jsx)(n.p,{children:"Run the following command to restore the latest backup of the database:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"docker compose run --rm restore\n"})}),"\n",(0,r.jsx)(n.h3,{id:"upgrading-to-a-new-version",children:"Upgrading to a new version"}),"\n",(0,r.jsxs)(n.p,{children:["New releases are announced in ",(0,r.jsx)(n.a,{href:"https://github.com/grit42/grit/discussions/categories/announcements",children:"Discussions"})," of the main repo on ",(0,r.jsx)(n.a,{href:"https://github.com/grit42/grit",children:"GitHub"}),". Additional steps or warnings may be specified in the release announcement, please read it carefully before upgrading."]}),"\n",(0,r.jsx)(n.p,{children:"Run the following command to upgrade to the latest version:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"docker compose pull app\ndocker compose up --no-deps --force-recreate app\n"})}),"\n",(0,r.jsx)(n.h2,{id:"upgrading-from-previous-sample-docker-compose",children:"Upgrading from previous sample docker compose"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure the values in the ",(0,r.jsx)(n.code,{children:".env"})," file match the environment in the compose file used to run the app before"]}),"\n",(0,r.jsxs)(n.li,{children:["In the directory containing the new ",(0,r.jsx)(n.code,{children:"docker-compose.yml"})," file, start the new ",(0,r.jsx)(n.code,{children:"db"})," service to create the volume","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"docker compose up -d db\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["In the directory containing the previous ",(0,r.jsx)(n.code,{children:"docker-compose.yml"})," file, copy database files into the volume using a helper container, for example on a Unix system:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:'docker run --rm \\\n    -v ./postgres-data:/from \\\n    -v grit_postgres_data:/to \\\n    alpine \\\n    sh -c "cd /from && tar cf - . | tar xf - -C /to"\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Fix database files ownership","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"docker run --rm \\\n  -v grit_postgres_data:/data \\\n  alpine \\\n  chown -R 999:999 /data\n"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8906:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(758);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);